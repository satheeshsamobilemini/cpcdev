/*
* Test Class for DodgeMcGrawHillDataWS
*/
 @isTest
private class DodgeMcGrawHillDataWSTest {

    static testMethod void loadProjectsTest() {
    
    // TFS 4430 - new Dodge Feed process    
    Account acc = new Account();
    acc.factorKey__c = 'TestAFTCA0002';
    acc.Name='TestAccountAFTCA0002';
    insert acc;
     
    // TFS 4330 - new Dodge Feed process 
   DodgeFeed__c dfeed = new DodgeFeed__c(Name = 'FlagSetTrue', Flagvalue_Set__c = true);
   insert dfeed;   
    
        String xmlString = '<?xml version="1.0" encoding="UTF-8"?>'
+'<projects>'
    +'<Project>'
        +'<ProjectName>TX Colombia-Solidarity Border Safety Re-Bid'+'</ProjectName>'
        +'<ProjectURL>http://Mobilemini.uat.constructionpoints.com/MainPage.aspx?Page=ProjectReport&amp;Source=DODG'+'E&amp;ProjectID=137040'+'</ProjectURL>'
        +'<DodgeReportNumber>Test00-668904'+'</DodgeReportNumber>'
        +'<Plans-SpecsAvailable>Yes'+'</Plans-SpecsAvailable>'
        +'<Manual/>'
        +'<DodgeReportDate>01/11/2010'+'</DodgeReportDate>'
        +'<Version>40'+'</Version>'
        +'<ActionStage>Start'+'</ActionStage>'
        +'<MarketSegment>Transport'+'</MarketSegment>'
        +'<PrimaryProjectType>Vehicle Sales/Service'+'</PrimaryProjectType>'
        +'<BidDate>12/09/2009'+'</BidDate>'
        +'<ProjectValuation>15,396,297'+'</ProjectValuation>'
        +'<SecondaryProjectTypes>Sidewalk/Parking Lot; Site Development'+'</SecondaryProjectTypes>'
        +'<SpecAlerts/>'
        +'<StatusText>Contract awarded - Construction to start within 30'
            +'days - Bid December 9</StatusText>'
        +'<Address1>Facility FM 255 near'+'</Address1>'
        +'<Address2>(International Bridge)'+'</Address2>'
        +'<CityName>Laredo'+'</CityName>'
        +'<CountyName>Webb County'+'</CountyName>'
        +'<StateAbbr>BC'+'</StateAbbr>'
        +'<ZipCode>V5T 1E2'+'</ZipCode>'
        +'<Country>Canada'+'</Country>'
        +'<TargetStartDate>02/2010'+'</TargetStartDate>'
        +'<OwnershipType>State Government'+'</OwnershipType>'
        +'<TypeOfWork>New Project'+'</TypeOfWork>'
        +'<NumberOfBuildings>1'+'</NumberOfBuildings>'
        +'<SqFt>48000'+'</SqFt>'
        +'<SpecialCode>DEB - Goal 5'+'</SpecialCode>'
        +'<Latitude/>'
        +'<Longitude/>'
        +'<FoundBy/>'
        +'<FoundByDetail/>'
        +'<Companies>'
            +'<Company>'
                +'<DodgeReportNumber>Test00-668904'+'</DodgeReportNumber>'
                +'<FactorType>GC'+'</FactorType>'
                +'<FactorKey>TestANDFL8564'+'</FactorKey>'
                +'<CKMS>CKS000000815671'+'</CKMS>'
                +'<CompanyURL>http://Mobilemini.uat.constructionpoints.com/MainPage.aspx?Page=CompanyReport&amp;Sou'+'rce=DODGE&amp;CompanyID=29349'+'</CompanyURL>'
                +'<CompanyName>Anderson Columbia Company Inc'+'</CompanyName>'
                +'<PhoneNumber>386-752-7585'+'</PhoneNumber>'
                +'<FaxNumber>386-755-5430'+'</FaxNumber>'
                +'<Address1>871 NW Guerdon St'+'</Address1>'
                +'<Address2/>'
                +'<CityName>Lake City'+'</CityName>'
                +'<CountyName>Columbia County'+'</CountyName>'
                +'<StateAbbr>FL'+'</StateAbbr>'
                +'<ZipCode>32055-4346'+'</ZipCode>'
                +'<Rank>0'+'</Rank>'
                +'<BidAmount>0.00'+'</BidAmount>'
                +'<ContactName/>'
                +'<ContactTitle/>'
                +'<DUNSNumber/>'
                +'<ParentDUNSNumber/>'
                +'<SICCode/>'
                +'<TrackingLists>'
                    +'<TrackingList Name="129883">'
                        +'<User EmailAddress="dneely@mobilemini.com"/>'
                    +'</TrackingList>'
                    +'<TrackingList Name="122702">'
                        +'<User EmailAddress="mmolina@mobilemini.com"/>'
                    +'</TrackingList>'
                    +'<TrackingList Name="123179">'
                        +'<User EmailAddress="gmcleod@mobilemini.com"/>'
                    +'</TrackingList>'
                +'</TrackingLists>'
            +'</Company>'
           
            +'<Company>'
                +'<DodgeReportNumber>Test00-668904'+'</DodgeReportNumber>'
                +'<FactorType>GC;GC'+'</FactorType>'
                +'<FactorKey>TestARCTX6538'+'</FactorKey>'
                +'<CKMS>CKS0000001'+'</CKMS>'
                +'<CompanyURL>http://Mobilemini.uat.constructionpoints.com/MainPage.aspx?Page=CompanyReport&amp;Source=DODGE&amp;CompanyID=13496'+'</CompanyURL>'
                +'<CompanyName>AUI General Contractors'+'</CompanyName>'
                +'<PhoneNumber>817-926-4377'+'</PhoneNumber>'
                +'<FaxNumber>817-926-4387'+'</FaxNumber>'
                +'<Address1>4775 North Fwy'+'</Address1>'
                +'<Address2/>'
                +'<CityName>Fort Worth'+'</CityName>'
                +'<CountyName>Tarrant County'+'</CountyName>'
                +'<StateAbbr>TX'+'</StateAbbr>'
                +'<ZipCode>76106-2315'+'</ZipCode>'
                +'<Rank>3'+'</Rank>'
                +'<BidAmount>16683151.00'+'</BidAmount>'
                +'<ContactName>Glenn Strother'+'</ContactName>'
                +'<ContactTitle>(Metro 817/429-8191'+'</ContactTitle>'
                +'<DUNSNumber/>'
                +'<ParentDUNSNumber/>'
                +'<SICCode/>'
                +'<TrackingLists>'
                    +'<TrackingList Name="My Prospect Companies">'
                        +'<User EmailAddress="lspears@mobilemini.com"/>'
                    +'</TrackingList>'
                +'</TrackingLists>'
            +'</Company>'
           +'</Companies>'
    +'</Project>';
    
    xmlString += '<Project>'
        +'<ProjectName>Bayview Branch Library Replacement'+'</ProjectName>'
        +'<ProjectURL>http://Mobilemini.uat.constructionpoints.com/MainPage.aspx?Page=ProjectReport&amp;Source=DODGE&amp;ProjectID=235476'+'</ProjectURL>'
        +'<DodgeReportNumber>Test00-734943'+'</DodgeReportNumber>'
        +'<Plans-SpecsAvailable>Yes'+'</Plans-SpecsAvailable>'
        +'<Manual/>'
        +'<DodgeReportDate>01/11/2010'+'</DodgeReportDate>'
        +'<Version>26'+'</Version>'
        +'<ActionStage>Bidding'+'</ActionStage>'
        +'<MarketSegment>School'+'</MarketSegment>'
        +'<PrimaryProjectType>Library'+'</PrimaryProjectType>'
        +'<BidDate>02/17/2010'+'</BidDate>'
        +'<ProjectValuation>4,900,000'+'</ProjectValuation>'
        +'<SecondaryProjectTypes/>'
        +'<SpecAlerts/>'
        +'<StatusText>Add bidder - GC bids to Owner February 17 at 2:30 PM'
            +'- Mandatory pre bid Jan 15 at 10 AM at site - Plans at'
            +'http://bsm.sfdpw.org/contractadmin or call 415-554-6229 for CD</StatusText>'
        +'<Address1>5075 3rd St'+'</Address1>'
        +'<Address2/>'
        +'<CityName>San Francisco'+'</CityName>'
        +'<CountyName>San Francisco County'+'</CountyName>'
        +'<StateAbbr>CA'+'</StateAbbr>'
        +'<ZipCode>941242311'+'</ZipCode>'
        +'<Country>United States'+'</Country>'
        +'<TargetStartDate/>'
        +'<OwnershipType>Local Government'+'</OwnershipType>'
        +'<TypeOfWork>New Project'+'</TypeOfWork>'
        +'<NumberOfBuildings>1'+'</NumberOfBuildings>'
        +'<SqFt>9000'+'</SqFt>'
        +'<SpecialCode>LEED Intended Gold'+'</SpecialCode>'
        +'<Latitude/>'
        +'<Longitude/>'
        +'<FoundBy/>'
        +'<FoundByDetail/>'
        +'<Companies>'
            +'<Company>'
                +'<DodgeReportNumber>Test00-734943'+'</DodgeReportNumber>'
                +'<FactorType>GC'+'</FactorType>'
                +'<FactorKey>TestAFTCA0002'+'</FactorKey>'
                +'<CKMS>CKS0000002'+'</CKMS>'
                +'<CompanyURL>http://Mobilemini.uat.constructionpoints.com/MainPage.aspx?Page=CompanyReport&amp;Source=DODGE&amp;CompanyID=470894'+'</CompanyURL>'
                +'<CompanyName>Alten Construction'+'</CompanyName>'
                +'<PhoneNumber>510-234-4200'+'</PhoneNumber>'
                +'<FaxNumber>510-234-4221'+'</FaxNumber>'
                +'<Address1>720 12th S'+'</Address1>'
                +'<Address2/>'
                +'<CityName>Richmond'+'</CityName>'
                +'<CountyName>Contra Costa County'+'</CountyName>'
                +'<StateAbbr>CA'+'</StateAbbr>'
                +'<ZipCode>94801-2365'+'</ZipCode>'
                +'<Rank>0'+'</Rank>'
                +'<BidAmount>0.00'+'</BidAmount>'
                +'<ContactName/>'
                +'<ContactTitle/>'
                +'<DUNSNumber/>'
                +'<ParentDUNSNumber/>'
                +'<SICCode/>'
                +'<TrackingLists/>'
            +'</Company>'
            +'<Company>'
                +'<DodgeReportNumber>Test00-734943'+'</DodgeReportNumber>'
                +'<FactorType>Owner (Public)'+'</FactorType>'
                +'<FactorKey>TestCOOCA0024'+'</FactorKey>'
                +'<CKMS>CKS0000003'+'</CKMS>'
                +'<CompanyURL>http://Mobilemini.uat.constructionpoints.com/MainPage.aspx?Page=CompanyReport&amp;Source=DODGE&amp;CompanyID=3777'+'</CompanyURL>'
                +'<CompanyName>City &amp; County of San Francisco'+'</CompanyName>'
                +'<PhoneNumber>415-554-6229'+'</PhoneNumber>'
                +'<FaxNumber>415-554-6232'+'</FaxNumber>'
                +'<Address1>875 Stevenson St Ste 420'+'</Address1>'
                +'<Address2/>'
                +'<CityName>San Francisco'+'</CityName>'
                +'<CountyName>San Francisco County'+'</CountyName>'
                +'<StateAbbr>CA'+'</StateAbbr>'
                +'<ZipCode>94103-0903'+'</ZipCode>'
                +'<Rank>0'+'</Rank>'
                +'<BidAmount>0.00'+'</BidAmount>'
                +'<ContactName>Public Works Department'+'</ContactName>'
                +'<ContactTitle/>'
                +'<DUNSNumber/>'
                +'<ParentDUNSNumber/>'
                +'<SICCode/>'
                +'<TrackingLists/>'
            +'</Company>'
          +'</Companies>'
    +'</Project>';
    
    xmlString += '<Project>'
        +'<ProjectName>Oxbow Meadows Environmental Learning Center'+'</ProjectName>'
        +'<ProjectURL>http://Mobilemini.uat.constructionpoints.com/MainPage.aspx?Page=ProjectReport&amp;Source=DODGE&amp;ProjectID=236538'+'</ProjectURL>'
        +'<DodgeReportNumber>Test00-735868'+'</DodgeReportNumber>'
        +'<Plans-SpecsAvailable>Yes'+'</Plans-SpecsAvailable>'
        +'<Manual/>'
        +'<DodgeReportDate>01/11/2010'+'</DodgeReportDate>'
        +'<Version>22'+'</Version>'
        +'<ActionStage>Subcontract Award'+'</ActionStage>'
        +'<MarketSegment>School'+'</MarketSegment>'
        +'<PrimaryProjectType>Miscellaneous Education Building'+'</PrimaryProjectType>'
        +'<BidDate>01/15/2010'+'</BidDate>'
        +'<ProjectValuation>1,300,000 - 1,600,000'+'</ProjectValuation>'
        +'<SecondaryProjectTypes>Animal/Plant/Fish Facility'+'</SecondaryProjectTypes>'
        +'<SpecAlerts/>'
        +'<StatusText>GC bids to Owner January 15 at 10 AM (EST) at 1421'
            +'Veterans Parkway - Columbus GA - ADD 3 Issued</StatusText>'
        +'<Address1>3535 S Lumpkin Rd'+'</Address1>'
        +'<Address2/>'
        +'<CityName>Columbus'+'</CityName>'
        +'<CountyName>Muscogee County'+'</CountyName>'
        +'<StateAbbr>GA'+'</StateAbbr>'
        +'<ZipCode>319034212'+'</ZipCode>'
        +'<Country>United States'+'</Country>'
        +'<TargetStartDate/>'
        +'<OwnershipType>Local Government'+'</OwnershipType>'
        +'<TypeOfWork>New Project'+'</TypeOfWork>'
        +'<NumberOfBuildings>1'+'</NumberOfBuildings>'
        +'<SqFt>7600'+'</SqFt>'
        +'<SpecialCode>10 MBE - 5 WBE Goals'+'</SpecialCode>'
        +'<Latitude/>'
        +'<Longitude/>'
        +'<FoundBy/>'
        +'<FoundByDetail/>'
        +'<Companies>'
            +'<Company>'
                +'<DodgeReportNumber>Test00-735868'+'</DodgeReportNumber>'
                +'<FactorType>Owner (Public)'+'</FactorType>'
                +'<FactorKey>TestCOLGA0002'+'</FactorKey>'
                +'<CKMS>CKS0000004'+'</CKMS>'
                +'<CompanyURL>http://Mobilemini.uat.constructionpoints.com/MainPage.aspx?Page=CompanyReport&amp;Source=DODGE&amp;CompanyID=56260'+'</CompanyURL>'
                +'<CompanyName>Columbus Water Works'+'</CompanyName>'
                +'<PhoneNumber>706-649-3471'+'</PhoneNumber>'
                +'<FaxNumber>706-649-3496'+'</FaxNumber>'
                +'<Address1>1421 Veterans Pkwy'+'</Address1>'
                +'<Address2/>'
                +'<CityName>Columbus'+'</CityName>'
                +'<CountyName>Muscogee County'+'</CountyName>'
                +'<StateAbbr>GA'+'</StateAbbr>'
                +'<ZipCode>31901-2127'+'</ZipCode>'
                +'<Rank>0'+'</Rank>'
                +'<BidAmount>0.00'+'</BidAmount>'
                +'<ContactName>Cliff Arnett'+'</ContactName>'
                +'<ContactTitle>Senior VP'+'</ContactTitle>'
                +'<DUNSNumber/>'
                +'<ParentDUNSNumber/>'
                +'<SICCode/>'
                +'<TrackingLists/>'
            +'</Company>'
            +'<Company>'
                +'<DodgeReportNumber>Test00-735868'+'</DodgeReportNumber>'
                +'<FactorType>GC'+'</FactorType>'
                +'<FactorKey>TestDDEGA4340'+'</FactorKey>'
                +'<CKMS>CKS0000005'+'</CKMS>'
                +'<CompanyURL>http://Mobilemini.uat.constructionpoints.com/MainPage.aspx?Page=CompanyReport&amp;Source=DODGE&amp;CompanyID=57881'+'</CompanyURL>'
                +'<CompanyName>D Dean and Associates'+'</CompanyName>'
                +'<PhoneNumber>706-321-0590'+'</PhoneNumber>'
                +'<FaxNumber>706-321-0413'+'</FaxNumber>'
                +'<Address1>350 Manchester Expy'+'</Address1>'
                +'<Address2/>'
                +'<CityName>Columbus'+'</CityName>'
                +'<CountyName>Muscogee County'+'</CountyName>'
                +'<StateAbbr>GA'+'</StateAbbr>'
                +'<ZipCode>31904-6435'+'</ZipCode>'
                +'<Rank>0'+'</Rank>'
                +'<BidAmount>0.00'+'</BidAmount>'
                +'<ContactName/>'
                +'<ContactTitle/>'
                +'<DUNSNumber/>'
                +'<ParentDUNSNumber/>'
                +'<SICCode/>'
                +'<TrackingLists/>'
            +'</Company>'
          +'</Companies>'
    +'</Project>'
+'</projects>';

    String actualResultString = DodgeMcGrawHillDataWS.loadProjects(xmlString);
    System.Debug('Result String '+actualResultString );
    Set<String> dodgeProjectNumberSet = new Set<String>();
    dodgeProjectNumberSet.add('Test00-668904');
    dodgeProjectNumberSet.add('Test00-735868');
    dodgeProjectNumberSet.add('Test00-734943');
    
    Set<String> biddingCompanyFactorKeySet = new Set<String>();
    
    biddingCompanyFactorKeySet.add('TestDDEGA4340');
    biddingCompanyFactorKeySet.add('TestAFTCA0002');
    biddingCompanyFactorKeySet.add('TestANDFL8564');
    biddingCompanyFactorKeySet.add('TestARCTX6538');
    
    //inserted project 
    List<Dodge_Project__c> dodgeProjectList = [Select Id,Name, Country__c, Branch_Id__c from Dodge_Project__c where dodge_Report_Number__c in :dodgeProjectNumberSet];
    System.Debug('$$$$$$ --> dodgeProjectList = ' + dodgeProjectList);
    ///System.assertEquals(dodgeProjectList.size(),3);
    
    List<Company__c> dodgecompanytList = [Select Id,Name from Company__c where dodge_Report_Number__c in : dodgeProjectNumberSet ];
    ////System.assertEquals(dodgecompanytList.size(),6);
    
    Map<Id,Lead> leadMapNew= new Map<ID, Lead>([select Id,Auto_Assign_Lead__c,factorKey__c from Lead where factorKey__c in : biddingCompanyFactorKeySet]);
    for(Id lId : leadMapNew.keySet()){
        System.Debug('Lead # for '+leadMapNew.get(lId).factorKey__c);
    }
    ////System.assertEquals(leadMapNew.size(),4);
    // Comment out the line below, use the one above after Leads are generated again
    // System.assertEquals(leadMapNew.size(),0);
    
    /* Changes in xml are 
    #  Add a new project with Test00-884785
    #  Change the Action Stage of Test00-668904 start to Bidding
    #  Remove a company from Test00-734943 
    #  Add a new company in Test00-735868 project
    #  Change the Action Stage of Test00-734943 bidding to Bid Results
    */
    xmlString = '<projects>'
    +'<Project>'
        +'<ProjectName>TX Colombia-Solidarity Border Safety Re-Bid'+'</ProjectName>'
        +'<ProjectURL>http://Mobilemini.uat.constructionpoints.com/MainPage.aspx?Page=ProjectReport&amp;Source=DODG'+'E&amp;ProjectID=137040'+'</ProjectURL>'
        +'<DodgeReportNumber>Test00-668904'+'</DodgeReportNumber>'
        +'<Plans-SpecsAvailable>Yes'+'</Plans-SpecsAvailable>'
        +'<Manual/>'
        +'<DodgeReportDate>01/11/2010'+'</DodgeReportDate>'
        +'<Version>40'+'</Version>'
        +'<ActionStage>Bidding'+'</ActionStage>'
        +'<MarketSegment>Transport'+'</MarketSegment>'
        +'<PrimaryProjectType>Vehicle Sales/Service'+'</PrimaryProjectType>'
        +'<BidDate>12/09/2009'+'</BidDate>'
        +'<ProjectValuation>15,396,297'+'</ProjectValuation>'
        +'<SecondaryProjectTypes>Sidewalk/Parking Lot; Site Development'+'</SecondaryProjectTypes>'
        +'<SpecAlerts/>'
        +'<StatusText>Contract awarded - Construction to start within 30'
            +'days - Bid December 9</StatusText>'
        +'<Address1>Facility FM 255 near'+'</Address1>'
        +'<Address2>(International Bridge)'+'</Address2>'
        +'<CityName>Laredo'+'</CityName>'
        +'<CountyName>Webb County'+'</CountyName>'
        +'<StateAbbr>TX'+'</StateAbbr>'
        +'<ZipCode>78040'+'</ZipCode>'
        +'<TargetStartDate>02/2010'+'</TargetStartDate>'
        +'<OwnershipType>State Government'+'</OwnershipType>'
        +'<TypeOfWork>New Project'+'</TypeOfWork>'
        +'<NumberOfBuildings>1'+'</NumberOfBuildings>'
        +'<SqFt>48000'+'</SqFt>'
        +'<SpecialCode>DEB - Goal 5'+'</SpecialCode>'
        +'<Latitude/>'
        +'<Longitude/>'
        +'<FoundBy/>'
        +'<FoundByDetail/>'
        +'<Companies>'
            +'<Company>'
                +'<DodgeReportNumber>Test00-668904'+'</DodgeReportNumber>'
                +'<FactorType>GC'+'</FactorType>'
                +'<FactorKey>TestANDFL8564'+'</FactorKey>'
                +'<CKMS>CKS0000011'+'</CKMS>'
                +'<CompanyURL>http://Mobilemini.uat.constructionpoints.com/MainPage.aspx?Page=CompanyReport&amp;Sou'+'rce=DODGE&amp;CompanyID=29349'+'</CompanyURL>'
                +'<CompanyName>Anderson Columbia Company Inc'+'</CompanyName>'
                +'<PhoneNumber>386-752-7585'+'</PhoneNumber>'
                +'<FaxNumber>386-755-5430'+'</FaxNumber>'
                +'<Address1>871 NW Guerdon St'+'</Address1>'
                +'<Address2/>'
                +'<CityName>Lake City'+'</CityName>'
                +'<CountyName>Columbia County'+'</CountyName>'
                +'<StateAbbr>FL'+'</StateAbbr>'
                +'<ZipCode>32055-4346'+'</ZipCode>'
                +'<Rank>0'+'</Rank>'
                +'<BidAmount>0.00'+'</BidAmount>'
                +'<ContactName/>'
                +'<ContactTitle/>'
                +'<DUNSNumber/>'
                +'<ParentDUNSNumber/>'
                +'<SICCode/>'
                +'<TrackingLists>'
                    +'<TrackingList Name="129883">'
                        +'<User EmailAddress="dneely@mobilemini.com"/>'
                    +'</TrackingList>'
                    +'<TrackingList Name="122702">'
                        +'<User EmailAddress="mmolina@mobilemini.com"/>'
                    +'</TrackingList>'
                    +'<TrackingList Name="123179">'
                        +'<User EmailAddress="gmcleod@mobilemini.com"/>'
                    +'</TrackingList>'
                +'</TrackingLists>'
            +'</Company>'
            +'<Company>'
                +'<DodgeReportNumber>Test00-668904'+'</DodgeReportNumber>'
                +'<FactorType>GC;GC'+'</FactorType>'
                +'<FactorKey>TestARCTX6538'+'</FactorKey>'
                +'<CKMS>CKS0000001'+'</CKMS>'
                +'<CompanyURL>http://Mobilemini.uat.constructionpoints.com/MainPage.aspx?Page=CompanyReport&amp;Source=DODGE&amp;CompanyID=13496'+'</CompanyURL>'
                +'<CompanyName>AUI General Contractors'+'</CompanyName>'
                +'<PhoneNumber>817-926-4377'+'</PhoneNumber>'
                +'<FaxNumber>817-926-4387'+'</FaxNumber>'
                +'<Address1>4775 North Fwy'+'</Address1>'
                +'<Address2/>'
                +'<CityName>Fort Worth'+'</CityName>'
                +'<CountyName>Tarrant County'+'</CountyName>'
                +'<StateAbbr>TX'+'</StateAbbr>'
                +'<ZipCode>76106-2315'+'</ZipCode>'
                +'<Rank>0'+'</Rank>'
                +'<BidAmount>0.00'+'</BidAmount>'
                +'<ContactName>Glenn Strother'+'</ContactName>'
                +'<ContactTitle>(Metro 817/429-8191'+'</ContactTitle>'
                +'<DUNSNumber/>'
                +'<ParentDUNSNumber/>'
                +'<SICCode/>'
                +'<TrackingLists>'
                    +'<TrackingList Name="My Prospect Companies">'
                        +'<User EmailAddress="lspears@mobilemini.com"/>'
                    +'</TrackingList>'
                +'</TrackingLists>'
            +'</Company>'
            
           +'</Companies>'
    +'</Project>';
    
    xmlString += '<Project>'
        +'<ProjectName>Harrison Branch Whitney Bank (Hurricane Rebuild)'+'</ProjectName>'
        +'<ProjectURL>http://Mobilemini.uat.constructionpoints.com/MainPage.aspx?Page=ProjectReport&amp;Source=DODG&amp;ProjectID=6594478'+'</ProjectURL>'
        +'<DodgeReportNumber>Test00-884785'+'</DodgeReportNumber>'
        +'<Plans-SpecsAvailable>Yes'+'</Plans-SpecsAvailable>'
        +'<Manual/>'
        +'<DodgeReportDate>01/28/2010'+'</DodgeReportDate>'
        +'<Version>6'+'</Version>'
        +'<ActionStage>GC Bidding-Invitation'+'</ActionStage>'
        +'<MarketSegment>Commercial'+'</MarketSegment>'
        +'<PrimaryProjectType>Bank'+'</PrimaryProjectType>'
        +'<BidDate>02/09/2010'+'</BidDate>'
        +'<ProjectValuation>$600,000'+'</ProjectValuation>'
        +'<SecondaryProjectTypes/>'
        +'<SpecAlerts/>'
        +'<StatusText>GC Bids (BY INVITATION ONLY) February 9 at 2pm (CST)</StatusText>'
        +'<Address1>875 Harrison Ave'+'</Address1>'
        +'<Address2/>'
        +'<CityName>New Orleans'+'</CityName>'
        +'<CountyName>Orleans Parish'+'</CountyName>'
        +'<StateAbbr>LA'+'</StateAbbr>'
        +'<ZipCode>701243154'+'</ZipCode>'
        +'<TargetStartDate/>'
        +'<OwnershipType>Private'+'</OwnershipType>'
        +'<TypeOfWork>New Project'+'</TypeOfWork>'
        +'<NumberOfBuildings>1'+'</NumberOfBuildings>'
        +'<SqFt>9000'+'</SqFt>'
        +'<SpecialCode>LEED Intended Gold'+'</SpecialCode>'
        +'<Latitude/>'
        +'<Longitude/>'
        +'<FoundBy/>'
        +'<FoundByDetail/>'
         +'<Companies>'
            +'<Company>'
                +'<DodgeReportNumber>Test00-884785</DodgeReportNumber>'
                +'<FactorType>Bidders</FactorType>'
                +'<FactorKey>TestAPOLA0001</FactorKey>'
                +'<CKMS>CKS0000007'+'</CKMS>'
                +'<CompanyURL>http://Mobilemini.uat.constructionpoints.com/MainPage.aspx?Page=CompanyReport&amp;Sou'+'e=DODGE&amp;CompanyID=21692</CompanyURL>'
                +'<CompanyName>Arkel Constructors Inc</CompanyName>'
                +'<PhoneNumber>225-344-1023</PhoneNumber>'
                +'<FaxNumber>225-344-9584</FaxNumber>'
                +'<Address1>Po Box 4307</Address1>'
                +'<Address2>1048 Florida St</Address2>'
                +'<CityName>Baton Rouge</CityName>'
                +'<CountyName>East Baton Rouge Parish</CountyName>'
                +'<StateAbbr>LA</StateAbbr>'
                +'<ZipCode>70821-4307</ZipCode>'
                +'<Rank>0</Rank>'
                +'<BidAmount>0.00</BidAmount>'
                +'<ContactName>Derek Fife</ContactName>'
                +'<ContactTitle>GC</ContactTitle>'
                +'<DUNSNumber/>'
                +'<ParentDUNSNumber/>'
                +'<SICCode/>'
                +'<TrackingLists/>'
            +'</Company>'
            +'<Company>'
                +'<DodgeReportNumber>Test00-884785</DodgeReportNumber>'
                +'<FactorType>Bidders</FactorType>'
                +'<FactorKey>TestCONLA0015</FactorKey>'
                +'<CKMS>CKS0000008'+'</CKMS>'
                +'<CompanyURL>http://Mobilemini.uat.constructionpoints.com/MainPage.aspx?Page=CompanyReport&amp;Sou'+'ce=DODGE&amp;CompanyID=76504</CompanyURL>'
                +'<CompanyName>Construction South, Inc.</CompanyName>'
                +'<PhoneNumber>504-834-2900</PhoneNumber>'
                +'<FaxNumber>504-834-2997</FaxNumber>'
                +'<Address1>721 Papworth Ave</Address1>'
                +'<Address2>PO Box 55150</Address2>'
                +'<CityName>METAIRIE</CityName>'
                +'<CountyName>Jefferson Parish</CountyName>'
                +'<StateAbbr>LA</StateAbbr>'
                +'<ZipCode>70005</ZipCode>'
                +'<Rank>0</Rank>'
                +'<BidAmount>0.00</BidAmount>'
                +'<ContactName>Mark Silva</ContactName>'
                +'<ContactTitle>General Contractor</ContactTitle>'
                +'<DUNSNumber/>'
                +'<ParentDUNSNumber/>'
                +'<SICCode/>'
                +'<TrackingLists/>'
            +'</Company>'
            +'<Company>'
                +'<DodgeReportNumber>Test00-884785</DodgeReportNumber>'
                +'<FactorType>Bidders</FactorType>'
                +'<FactorKey>TestDONLA0017</FactorKey>'
                +'<CKMS>CKS0000009'+'</CKMS>'
                +'<CompanyURL>http://Mobilemini.uat.constructionpoints.com/MainPage.aspx?Page=CompanyReport&amp;Sou'+'ce=DODGE&amp;CompanyID=10951</CompanyURL>'
                +'<CompanyName>DonahueFavret Contractors Inc</CompanyName>'
                +'<PhoneNumber>985-626-4431</PhoneNumber>'
                +'<FaxNumber>985-626-3572</FaxNumber>'
                +'<Address1>3030 E Causeway Approach</Address1>'
                +'<Address2/>'
                +'<CityName>Mandeville</CityName>'
                +'<CountyName>St. Tammany Parish</CountyName>'
                +'<StateAbbr>LA</StateAbbr>'
                +'<ZipCode>70448-3562</ZipCode>'
                +'<Rank>0</Rank>'
                +'<BidAmount>0.00</BidAmount>'
                +'<ContactName>Danny Plunkett</ContactName>'
                +'<ContactTitle>Estimating Dept</ContactTitle>'
                +'<DUNSNumber/>'
                +'<ParentDUNSNumber/>'
                +'<SICCode/>'
                +'<TrackingLists/>'
            +'</Company>'
            +'<Company>'
                +'<DodgeReportNumber>Test00-884785</DodgeReportNumber>'
                +'<FactorType>Bidders</FactorType>'
                +'<FactorKey>TestGOLLA0003</FactorKey>'
                +'<CKMS>CKS0000010'+'</CKMS>'
                +'<CompanyURL>http://Mobilemini.uat.constructionpoints.com/MainPage.aspx?Page=CompanyReport&amp;Sou'+'ce=DODGE&amp;CompanyID=28864</CompanyURL>'
                +'<CompanyName>Goliath Const Co Inc</CompanyName>'
                +'<PhoneNumber>504-837-6515</PhoneNumber>'
                +'<FaxNumber>504-837-6519</FaxNumber>'
                +'<Address1>2700 Metairie Lawn Dr</Address1>'
                +'<Address2/>'
                +'<CityName>METAIRIE</CityName>'
                +'<CountyName>Jefferson Parish</CountyName>'
                +'<StateAbbr>LA</StateAbbr>'
                +'<ZipCode>70002</ZipCode>'
                +'<Rank>0</Rank>'
                +'<BidAmount>0.00</BidAmount>'
                +'<ContactName/>'
                +'<ContactTitle/>'
                +'<DUNSNumber/>'
                +'<ParentDUNSNumber/>'
                +'<SICCode/>'
                +'<TrackingLists/>'
            +'</Company>'
            +'</Companies>'
            +'</Project>' ;
    
     xmlString += '<Project>'
        +'<ProjectName>Oxbow Meadows Environmental Learning Center'+'</ProjectName>'
        +'<ProjectURL>http://Mobilemini.uat.constructionpoints.com/MainPage.aspx?Page=ProjectReport&amp;Source=DODGE&amp;ProjectID=236538'+'</ProjectURL>'
        +'<DodgeReportNumber>Test00-735868'+'</DodgeReportNumber>'
        +'<Plans-SpecsAvailable>Yes'+'</Plans-SpecsAvailable>'
        +'<Manual/>'
        +'<DodgeReportDate>01/11/2010'+'</DodgeReportDate>'
        +'<Version>22'+'</Version>'
        +'<ActionStage>GC Bidding'+'</ActionStage>'
        +'<MarketSegment>School'+'</MarketSegment>'
        +'<PrimaryProjectType>Miscellaneous Education Building'+'</PrimaryProjectType>'
        +'<BidDate>01/15/2010'+'</BidDate>'
        +'<ProjectValuation>1,300,000 - 1,600,000'+'</ProjectValuation>'
        +'<SecondaryProjectTypes>Animal/Plant/Fish Facility'+'</SecondaryProjectTypes>'
        +'<SpecAlerts/>'
        +'<StatusText>GC bids to Owner January 15 at 10 AM (EST) at 1421'
            +'Veterans Parkway - Columbus GA - ADD 3 Issued</StatusText>'
        +'<Address1>3535 S Lumpkin Rd'+'</Address1>'
        +'<Address2/>'
        +'<CityName>Columbus'+'</CityName>'
        +'<CountyName>Muscogee County'+'</CountyName>'
        +'<StateAbbr>GA'+'</StateAbbr>'
        +'<ZipCode>319034212'+'</ZipCode>'
        +'<TargetStartDate/>'
        +'<OwnershipType>Local Government'+'</OwnershipType>'
        +'<TypeOfWork>New Project'+'</TypeOfWork>'
        +'<NumberOfBuildings>1'+'</NumberOfBuildings>'
        +'<SqFt>7600'+'</SqFt>'
        +'<SpecialCode>10 MBE - 5 WBE Goals'+'</SpecialCode>'
        +'<Latitude/>'
        +'<Longitude/>'
        +'<FoundBy/>'
        +'<FoundByDetail/>'
        +'<Companies>'
            +'<Company>'
                +'<DodgeReportNumber>Test00-735868'+'</DodgeReportNumber>'
                +'<FactorType>Owner (Public)'+'</FactorType>'
                +'<FactorKey>TestCOLGA0002'+'</FactorKey>'
                +'<CKMS>CKS0000004'+'</CKMS>'
                +'<CompanyURL>http://Mobilemini.uat.constructionpoints.com/MainPage.aspx?Page=CompanyReport&amp;Source=DODGE&amp;CompanyID=56260'+'</CompanyURL>'
                +'<CompanyName>Columbus Water Works'+'</CompanyName>'
                +'<PhoneNumber>706-649-3471'+'</PhoneNumber>'
                +'<FaxNumber>706-649-3496'+'</FaxNumber>'
                +'<Address1>1421 Veterans Pkwy'+'</Address1>'
                +'<Address2/>'
                +'<CityName>Columbus'+'</CityName>'
                +'<CountyName>Muscogee County'+'</CountyName>'
                +'<StateAbbr>GA'+'</StateAbbr>'
                +'<ZipCode>31901-2127'+'</ZipCode>'
                +'<Rank>0'+'</Rank>'
                +'<BidAmount>0.00'+'</BidAmount>'
                +'<ContactName>Cliff Arnett'+'</ContactName>'
                +'<ContactTitle>Senior VP'+'</ContactTitle>'
                +'<DUNSNumber/>'
                +'<ParentDUNSNumber/>'
                +'<SICCode/>'
                +'<TrackingLists/>'
            +'</Company>'
            +'<Company>'
                +'<DodgeReportNumber>Test00-735868'+'</DodgeReportNumber>'
                +'<FactorType>Owner (Public)'+'</FactorType>'
                +'<FactorKey>TestCOOCA0056'+'</FactorKey>'
                +'<CKMS>CKS0000006'+'</CKMS>'
                +'<CompanyURL>http://Mobilemini.uat.constructionpoints.com/MainPage.aspx?Page=CompanyReport&amp;Source=DODGE&amp;CompanyID=3777'+'</CompanyURL>'
                +'<CompanyName>City &amp; County of San Francisco'+'</CompanyName>'
                +'<PhoneNumber>415-554-6229'+'</PhoneNumber>'
                +'<FaxNumber>415-554-6232'+'</FaxNumber>'
                +'<Address1>875 Stevenson St Ste 420'+'</Address1>'
                +'<Address2/>'
                +'<CityName>San Francisco'+'</CityName>'
                +'<CountyName>San Francisco County'+'</CountyName>'
                +'<StateAbbr>CA'+'</StateAbbr>'
                +'<ZipCode>94103-0903'+'</ZipCode>'
                +'<Rank>0'+'</Rank>'
                +'<BidAmount>0.00'+'</BidAmount>'
                +'<ContactName>Public Works Department'+'</ContactName>'
                +'<ContactTitle/>'
                +'<DUNSNumber/>'
                +'<ParentDUNSNumber/>'
                +'<SICCode/>'
                +'<TrackingLists/>'
            +'</Company>'
            +'<Company>'
                +'<DodgeReportNumber>Test00-735868'+'</DodgeReportNumber>'
                +'<FactorType>GC'+'</FactorType>'
                +'<FactorKey>TestDDEGA4340'+'</FactorKey>'
                +'<CKMS>CKS0000005'+'</CKMS>'
                +'<CompanyURL>http://Mobilemini.uat.constructionpoints.com/MainPage.aspx?Page=CompanyReport&amp;Source=DODGE&amp;CompanyID=57881'+'</CompanyURL>'
                +'<CompanyName>D Dean and Associates'+'</CompanyName>'
                +'<PhoneNumber>706-321-0590'+'</PhoneNumber>'
                +'<FaxNumber>706-321-0413'+'</FaxNumber>'
                +'<Address1>350 Manchester Expy'+'</Address1>'
                +'<Address2/>'
                +'<CityName>Columbus'+'</CityName>'
                +'<CountyName>Muscogee County'+'</CountyName>'
                +'<StateAbbr>GA'+'</StateAbbr>'
                +'<ZipCode>31904-6435'+'</ZipCode>'
                +'<Rank>0'+'</Rank>'
                +'<BidAmount>0.00'+'</BidAmount>'
                +'<ContactName/>'
                +'<ContactTitle/>'
                +'<DUNSNumber/>'
                +'<ParentDUNSNumber/>'
                +'<SICCode/>'
                +'<TrackingLists/>'
            +'</Company>'
          +'</Companies>'
    +'</Project>';
    
    xmlString += '<Project>'
        +'<ProjectName>Bayview Branch Library Replacement'+'</ProjectName>'
        +'<ProjectURL>http://Mobilemini.uat.constructionpoints.com/MainPage.aspx?Page=ProjectReport&amp;Source=DODGE&amp;ProjectID=235476'+'</ProjectURL>'
        +'<DodgeReportNumber>Test00-734943'+'</DodgeReportNumber>'
        +'<Plans-SpecsAvailable>Yes'+'</Plans-SpecsAvailable>'
        +'<Manual/>'
        +'<DodgeReportDate>01/11/2010'+'</DodgeReportDate>'
        +'<Version>26'+'</Version>'
        +'<ActionStage>Bid Results'+'</ActionStage>'
        +'<MarketSegment>School'+'</MarketSegment>'
        +'<PrimaryProjectType>Library'+'</PrimaryProjectType>'
        +'<BidDate>02/17/2010'+'</BidDate>'
        +'<ProjectValuation>4,900,000'+'</ProjectValuation>'
        +'<SecondaryProjectTypes/>'
        +'<SpecAlerts/>'
        +'<StatusText>Add bidder - GC bids to Owner February 17 at 2:30 PM'
            +'- Mandatory pre bid Jan 15 at 10 AM at site - Plans at'
            +'http://bsm.sfdpw.org/contractadmin or call 415-554-6229 for CD</StatusText>'
        +'<Address1>5075 3rd St'+'</Address1>'
        +'<Address2/>'
        +'<CityName>San Francisco'+'</CityName>'
        +'<CountyName>San Francisco County'+'</CountyName>'
        +'<StateAbbr>CA'+'</StateAbbr>'
        +'<ZipCode>941242311'+'</ZipCode>'
        +'<TargetStartDate/>'
        +'<OwnershipType>Local Government'+'</OwnershipType>'
        +'<TypeOfWork>New Project'+'</TypeOfWork>'
        +'<NumberOfBuildings>1'+'</NumberOfBuildings>'
        +'<SqFt>9000'+'</SqFt>'
        +'<SpecialCode>LEED Intended Gold'+'</SpecialCode>'
        +'<Latitude/>'
        +'<Longitude/>'
        +'<FoundBy/>'
        +'<FoundByDetail/>'
        +'<Companies>'
            +'<Company>'
                +'<DodgeReportNumber>Test00-734943'+'</DodgeReportNumber>'
                +'<FactorType>GC'+'</FactorType>'
                +'<FactorKey>TestAFTCA0002'+'</FactorKey>'
                +'<CKMS>CKS0000002'+'</CKMS>'
                +'<CompanyURL>http://Mobilemini.uat.constructionpoints.com/MainPage.aspx?Page=CompanyReport&amp;Source=DODGE&amp;CompanyID=470894'+'</CompanyURL>'
                +'<CompanyName>Alten Construction'+'</CompanyName>'
                +'<PhoneNumber>510-234-4200'+'</PhoneNumber>'
                +'<FaxNumber>510-234-4221'+'</FaxNumber>'
                +'<Address1>720 12th S'+'</Address1>'
                +'<Address2/>'
                +'<CityName>Richmond'+'</CityName>'
                +'<CountyName>Contra Costa County'+'</CountyName>'
                +'<StateAbbr>CA'+'</StateAbbr>'
                +'<ZipCode>94801-2365'+'</ZipCode>'
                +'<Rank>0'+'</Rank>'
                +'<BidAmount>0.00'+'</BidAmount>'
                +'<ContactName/>'
                +'<ContactTitle/>'
                +'<DUNSNumber/>'
                +'<ParentDUNSNumber/>'
                +'<SICCode/>'
                +'<TrackingLists/>'
            +'</Company>'
            
          +'</Companies>'
    +'</Project>'
    +'</projects>';
   
   Test.startTest();
    DodgeMcGrawHillDataWS.loadProjects(xmlString);
    dodgeProjectNumberSet.add('Test00-884785');
    
    biddingCompanyFactorKeySet.add('TestANDFL8564');
    biddingCompanyFactorKeySet.add('TestARCTX6538');
   Test.stopTest();
   
     //inserted project 
    dodgeProjectList = [Select Id,Name from Dodge_Project__c where dodge_Report_Number__c in :dodgeProjectNumberSet];
    ////System.assertEquals(dodgeProjectList.size(),4);
    
    dodgecompanytList = [Select Id,Name from Company__c where dodge_Report_Number__c in : dodgeProjectNumberSet ];
    ////System.assertEquals(dodgecompanytList.size(),10);
    
    Map<Id,Lead> leadMapUpdated= new Map<ID, Lead>([select Id,Auto_Assign_Lead__c,factorKey__c,Dodge_Project__c from Lead where factorKey__c in : biddingCompanyFactorKeySet]);
    for(Id lId : leadMapUpdated.keySet()){
       System.Debug('Lead # for '+leadMapUpdated.get(lId).factorKey__c+'Dodge Project '+leadMapUpdated.get(lId).dodge_Project__c);
    }
  }
  
  

}